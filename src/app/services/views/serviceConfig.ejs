<% if (locals.flash.info) { %>
<div class="row">
    <div class="col-12">
        <div class="notification notification-success">
            <%=locals.flash.info%>
        </div>
    </div>
</div>
<% } %>

<div class="row">
    <div class="col-8">
        <h1 class="heading-xlarge">Service configuration</h1>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <form method="post" id="form-service-config">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>"/>
            <dl class="app-check-your-answers app-check-your-answers--short">
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__title">
                        Service details
                    </dt>
                    <dd class="app-check-your-answers__change ">
                    </dd>
                </div>
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Service name
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div class="form-group <%= (locals.validationMessages.name !== undefined) ? 'form-group-error' : '' %>">
                            <label for="name" class="vh">Service name</label>
                            <% if (locals.validationMessages.name !== undefined) { %>
                            <p class="error-message" id="validation-name"><%=locals.validationMessages.name %></p>
                            <% } %>
                            <input class="form-control inputConfig" id="name" name="name" type="text" value="<%=locals.service.name%>">
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Description
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <label for="description" class="vh">Service description</label>
                            <textarea class="form-control inputConfig" id="description" name="description" rows = '5' style="resize:none;"><%=locals.service.description%></textarea>
                    </dd>

                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Home Url
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div class="form-group <%= (locals.validationMessages.serviceHome !== undefined) ? 'form-group-error' : '' %>">
                            <label for="serviceHome" class="vh">Home url</label>
                            <% if (locals.validationMessages.serviceHome !== undefined) { %>
                            <p class="error-message" id="validation-homeUrl"><%=locals.validationMessages.serviceHome %></p>
                            <% } %>
                            <input class="form-control inputConfig" id="serviceHome" name="serviceHome" type="text" value="<%=locals.service.relyingParty.service_home%>">
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Post-reset Url
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <label for="postResetUrl" class="vh">Post-reset Url</label>
                        <input class="form-control inputConfig" id="postResetUrl" name="postResetUrl" type="text" value="<%=locals.service.relyingParty.postResetUrl%>">
                    </dd>
                </div>
            </dl>

            <dl class="app-check-your-answers app-check-your-answers--short">
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__title">
                        OpenID Connect
                    </dt>
                    <dd class="app-check-your-answers__change ">
                    </dd>
                </div>
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Client Id
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div class="form-group <%= (locals.validationMessages.clientId !== undefined) ? 'form-group-error' : '' %>">
                            <label for="clientId" class="vh">Client Id</label>
                            <% if (locals.validationMessages.clientId !== undefined) { %>
                            <p class="error-message" id="validation-homeUrl"><%=locals.validationMessages.clientId %></p>
                            <% } %>
                            <input class="form-control inputConfig" id="clientId" name="clientId" type="text" value="<%=locals.service.relyingParty.client_id%>">
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Client secret
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <label for="clientSecret" class="vh">Client secret</label>
                        <a href="" class="pull-right" id="generate-client-secret">Regenerate</a>
                        <div class="show-password full-width" style="width: 75%">
                            <input class="form-control" id="clientSecret" name="clientSecret" type="password" value="<%=locals.service.relyingParty.client_secret%>" disabled="disabled">
                        </div>
                    </dd>

                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Redirect Urls
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div id ="redirect-url">
                            <a href="" class="pull-right" id="add-redirect">Add Url</a>
                            <% if (locals.service.relyingParty.redirect_uris.length > 0) { %>
                                <% for (let i=0; i < locals.service.relyingParty.redirect_uris.length; i++) {
                                const redirect_uri = locals.service.relyingParty.redirect_uris[i]%>
                                <label for="<%=redirect_uri%>" class="vh">Redirect url</label>
                                <p><input class="form-control inputConfig" id="<%=redirect_uri%>" name="redirect_uris" value="<%=redirect_uri%>"></p>
                                <% } %>
                            <% } else { %>
                            <label for="redirect" class="vh">Redirect url</label>
                            <p><input class="form-control inputConfig" id="redirect" name="redirect_uris"></p>
                            <% } %>
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Logout redirect Urls
                    </dt>

                    <dd class="app-check-your-answers__answer">
                        <div id ="logout-url">

                            <a href="" class="pull-right" id="add-logout">Add Url</a>
                            <% if (locals.service.relyingParty.post_logout_redirect_uris.length > 0) { %>
                                <% for (let i=0; i < locals.service.relyingParty.post_logout_redirect_uris.length; i++) {
                                const logout_redirect = locals.service.relyingParty.post_logout_redirect_uris[i]%>
                                <label for="<%=logout_redirect%>" class="vh">Logout redirect Urls</label>
                                <p><input class="form-control inputConfig" id="<%=logout_redirect%>" name="post_logout_redirect_uris" value="<%=logout_redirect%>"></p>
                                <% } %>
                            <% } else { %>
                                <label for="post_logout_redirect_uris" class="vh">Redirect url</label>
                                <p><input class="form-control inputConfig" id="post_logout_redirect_uris" name="post_logout_redirect_uris"></p>
                            <% } %>
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Grant types
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div class="form-group">
                            <label class="form-label vh" for="grant_types">Grant types</label>
                            <select class="form-control inputConfig" id="grant_types" name="grant_types">
                                <option disabled <%= locals.grantTypes === '' ? 'selected="selected"' : ''%> value>Select grant type</option>
                                <option <%= locals.grantTypes === 'authorization_code' ? 'selected="selected"' : ''%> value="authorization_code">authorization_code</option>
                                <option <%= locals.grantTypes === 'implicit' ? 'selected="selected"' : ''%>value="implicit">implicit</option>
                                <option <%= locals.grantTypes === 'client_credentials' ? 'selected="selected"' : ''%>value="client_credentials">client_credentials</option>
                            </select>
                        </div>
                    </dd>
                </div>

                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Response types
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <div class="form-group">
                            <label class="form-label vh" for="response_types">Response types</label>
                            <select class="form-control inputConfig" id="response_types" name="response_types">
                                <option disabled <%= locals.responseTypes === '' ? 'selected="selected"' : ''%> value>Select response type</option>
                                <option <%= locals.responseTypes === 'code,id_token,token' ? 'selected="selected"' : ''%> value="code,id_token,token">code, id_token, token</option>
                                <option <%= locals.responseTypes === 'code,id_token' ? 'selected="selected"' : ''%>value="code,id_token">code, id_token</option>
                                <option <%= locals.responseTypes === 'code,token' ? 'selected="selected"' : ''%> value="code,token">code, token</option>
                                <option <%= locals.responseTypes === 'code' ? 'selected="selected"' : ''%> value="code">code</option>
                                <option <%= locals.responseTypes === 'id_token,token' ? 'selected="selected"' : ''%> value="id_token,token">id_token, token</option>
                                <option <%= locals.responseTypes === 'id_token' ? 'selected="selected"' : ''%> value="id_token">id_token</option>
                                <option <%= locals.responseTypes === '' ? 'selected="selected"' : ''%> value="none">none</option>
                            </select>
                        </div>
                    </dd>
                </div>
            </dl>

            <dl class="app-check-your-answers app-check-your-answers--short">
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__title">
                        API
                    </dt>
                    <dd class="app-check-your-answers__change ">
                    </dd>
                </div>
                <div class="app-check-your-answers__contents">
                    <dt class="app-check-your-answers__question">
                        Secret
                    </dt>
                    <dd class="app-check-your-answers__answer">
                        <label class="form-label vh" for="apiSecret"></label>
                        <div class="show-password full-width" style="width: 75%">
                            <input class="form-control" id="apiSecret" name="apiSecret" type="password" value="<%=locals.service.relyingParty.api_secret%>" disabled="disabled">
                        </div>
                    </dd>
                </div>
            </dl>

            <div class="form-submit submit-buttons">
                <button type="submit" class="button">Save</button>
                <a href="./" class="button button-secondary">Cancel</a>
            </div>


        </form>
    </div>
</div>
